<!--
/* 
 * (C) 2020 TekMonks. All rights reserved.
 * License: See enclosed license.txt file.
 */
 -->
<style>
body {
    margin: 0%;
    height: 100%;
}

table {
    table-layout: fixed;
    width: 100%;
    border-spacing: 0px;
}

td {
    border: 1px solid #444444;
    border-radius: 0px;
    background-color: white;
    width: 5em;
    padding: 0px;
}

td > textarea {
    background-color: transparent;
    border: 0px;
    outline: none;
    color: inherit;
    resize: none;
    padding: 4px;
    width: 100%;
    overflow: hidden;
    font-family: inherit;
}

td.head {
    background-color: #444444; 
    color: white; 
    border-right-color: white;
}

tr td:last-child.head {border-right-color: #444444}

td:focus-within {background-color: yellow; color: #444444;}
td > textarea:focus {background-color: yellow; color: #444444;}

span#toolbar {
    padding-bottom: 10px; 
    display: inline-flex;
    align-items: center;
    width: 100%;
    flex-direction: row;
    justify-content: space-between;
    max-width: calc(100vw - 192px);
}

span#toolbar > span > span {
    align-items: center;
    display: inline-flex;
    font-size: smaller;
    font-family: 'Red Hat Text';
    padding-right: 4vw;
}

span#toolbar > span > span:last-child {padding-right: 0vw;}

span#toolbar > span > span.button {
    padding: 5px 10px 5px 10px;
    border: 1px solid #C6E3FF;
    border-radius: 5px;
    background-color: #D6EFFF;
    cursor: default;
    margin-right: 4vw;
}

span#toolbar span#middleitems {margin-left: 5vw; margin-right: 5vw;}

span#toolbar > span > span.button:last-child {margin-right: 0vw;}

</style>

{{{styleBody}}}

<span id="toolbar">
    <span id="leftitems">
        <span><img src="{{{componentPath}}}/img/delete.svg" onclick='monkshu_env.components["spread-sheet"].rowop("delete",this)'>&nbsp;&nbsp;Rows&nbsp;&nbsp;<img src="{{{componentPath}}}/img/add.svg" onclick='monkshu_env.components["spread-sheet"].rowop("add",this)'></span>
        <span><img src="{{{componentPath}}}/img/delete.svg" onclick='monkshu_env.components["spread-sheet"].columnop("delete",this)'>&nbsp;&nbsp;Cloumns&nbsp;&nbsp;<img src="{{{componentPath}}}/img/add.svg" onclick='monkshu_env.components["spread-sheet"].columnop("add",this)'></span>
    </span>
    <span id="middleitems">
        <span class="button"><img src="{{{componentPath}}}/img/test.svg">&nbsp;&nbsp;Test</span>
    </span>
    <span id="rightitems">
        <span class="button" onclick='monkshu_env.components["spread-sheet"].open(this)'><img src="{{{componentPath}}}/img/open.svg">&nbsp;&nbsp;Load</span>
        <span class="button" onclick='monkshu_env.components["spread-sheet"].save(this)'><img src="{{{componentPath}}}/img/save.svg">&nbsp;&nbsp;Save</span>
    </span>
</span>
<table id="spreadsheet">
    <tr>
        {{#columns}}<td class="head" onclick='this.querySelector("textarea").focus()'><textarea rows="1" 
            onpaste='monkshu_env.components["spread-sheet"].cellpastedon(this, event)'
            oninput='this.style.height=monkshu_env.components["spread-sheet"].getLargestRowScrollHeight(this.parentElement.parentElement.querySelectorAll("textarea"), this)+"px"; this.parentElement.style.height = this.style.height;'
            onchange="this.oninput()" onfocus="this.oninput()"
            onkeypress="if (event.keyCode == 13) event.preventDefault();"></textarea>
        </td>{{/columns}}
    </tr>
    {{#rows}}
    <tr>
        {{#columns}}<td onclick='this.querySelector("textarea").focus()'><textarea rows="1" 
            onpaste='monkshu_env.components["spread-sheet"].cellpastedon(this, event)'
            oninput='this.style.height=monkshu_env.components["spread-sheet"].getLargestRowScrollHeight(this.parentElement.parentElement.querySelectorAll("textarea"), this)+"px"; this.parentElement.style.height = this.style.height;'
            onchange="this.oninput()" onfocus="this.oninput()"
            onkeypress="if (event.keyCode == 13) event.preventDefault();"></textarea>
        </td>{{/columns}}
    </tr>
    {{/rows}}
</table>