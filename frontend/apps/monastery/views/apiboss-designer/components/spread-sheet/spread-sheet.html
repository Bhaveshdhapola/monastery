<!--
/* 
 * (C) 2020 TekMonks. All rights reserved.
 * License: See enclosed license.txt file.
 */
 -->
<style>
body {
    margin: 0%;
    height: 100%;
}

table {
    table-layout: fixed;
    width: 100%;
    border-spacing: 0px;
    border-radius: 5px 5px 5px 5px;
    border: 0.5px solid #444444;
    overflow-y: auto;

}

td {
    border: 1px solid #444444;
    border-radius: 0px;
    background-color: white;
    width: 5em;
    padding: 0px;
    overflow: hidden;
}

td > textarea {
    background-color: transparent;
    border: 0px;
    outline: none;
    color: inherit;
    resize: none;
    padding: 4px;
    width: 100%;
    overflow: hidden;
    font-family: inherit;
    display: block;
    box-sizing: border-box;
}

tr:first-child > td {
    background-color: rgba(152, 204, 253, 1); 
    color: white; 
    border-right-color: white;
}

tr:first-child > td:last-child {border-color: #444444; border-top-right-radius: 4px;}
tr:last-child > td:last-child {border-color: #444444; border-bottom-right-radius: 4px;}

td:focus-within {background-color: yellow; color: #444444;}
td > textarea:focus {background-color: yellow; color: #444444;}

span#toolbar {
    padding-bottom: 10px; 
    display: inline-flex;
    align-items: center;
    width: 100%;
    flex-direction: row;
    justify-content: space-between;
    max-width: calc(100vw - 192px);
}

span#toolbar > span > span {
    align-items: center;
    display: inline-flex;
    font-size: smaller;
    font-family: 'Red Hat Text';
    padding-right: 4vw;
}

span#toolbar > span > span:last-child {padding-right: 0vw;}

span#toolbar > span > span.button {
    padding: 5px 10px 5px 10px;
    border: 1px solid #C6E3FF;
    border-radius: 5px;
    background-color: #D6EFFF;
    cursor: default;
    margin-right: 4vw;
}


span#toolbar > span > span.button:last-child {margin-right: 0vw;}


img.button {width: 20px;}
</style>

{{{styleBody}}}

<span id="toolbar">
    <span id="leftitems">
        <span><img src="{{{componentPath}}}/img/delete.svg" onclick='monkshu_env.components["spread-sheet"].rowop("delete",this)'>&nbsp;&nbsp;{{i18n.Rows}}&nbsp;&nbsp;<img src="{{{componentPath}}}/img/add.svg" onclick='monkshu_env.components["spread-sheet"].rowop("add",this)'></span>
    </span>
</span>

<table id="spreadsheet">
    {{#rows}}
    <tr>
        {{#columns}}<td onclick='this.querySelector("textarea").focus()'><textarea rows="1" 
            onpaste='monkshu_env.components["spread-sheet"].cellpastedon(this, event)'
            oninput='monkshu_env.components["spread-sheet"].resizeRowInputsForLargestScroll(this)'
            onchange="this.oninput()" onfocus="this.oninput()" spellcheck="false"
            onkeypress="if (event.keyCode == 13) event.preventDefault();"></textarea>
        </td>{{/columns}}
    </tr>
    {{/rows}}
</table>

